<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><style>html{display:none}</style><meta name=author content="eduardo aleixo's cafofo"><meta name=description content="eduardo aleixo's personal website"><meta name=keywords content="developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automounting Steam Deck SD Card"><meta name=twitter:description content="Normally (I guess), you need to first enter Desktop Mode, which will automount the SD card. Then you can go back to Game Mode and play your games from the SD card (mostly emulation :) ).
A good thing of the steam deck is that it just runs Linux, so we can use same old tools we are used too. What we want here is to add the sd card to fstab"><meta property="og:title" content="Automounting Steam Deck SD Card"><meta property="og:description" content="Normally (I guess), you need to first enter Desktop Mode, which will automount the SD card. Then you can go back to Game Mode and play your games from the SD card (mostly emulation :) ).
A good thing of the steam deck is that it just runs Linux, so we can use same old tools we are used too. What we want here is to add the sd card to fstab"><meta property="og:type" content="article"><meta property="og:url" content="https://www.eduardoaleixo.com/posts/2024/automounting-steam-deck-sd-card/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-25T12:43:04+01:00"><meta property="article:modified_time" content="2024-08-25T12:43:04+01:00"><base href=https://www.eduardoaleixo.com/posts/2024/automounting-steam-deck-sd-card/><title>Automounting Steam Deck SD Card · eduardoaleixo</title><link rel=canonical href=https://www.eduardoaleixo.com/posts/2024/automounting-steam-deck-sd-card/><link rel=stylesheet href=https://www.eduardoaleixo.com/css/coder.min.0caa4ac67ec36ec2dedf930b12e60fdae22c952b84d9f102d59ced9d35491132.css integrity="sha256-DKpKxn7DbsLe35MLEuYP2uIslSuE2fEC1ZztnTVJETI=" crossorigin=anonymous media=screen><script type=text/javascript src=https://www.eduardoaleixo.com/js/script.js></script>
<script>!sessionStorage.getItem("_swa")&&document.referrer.indexOf(location.protocol+"//"+location.host)!==0&&fetch("https://counter.dev/track?"+new URLSearchParams({referrer:document.referrer,screen:screen.width+"x"+screen.height,user:"eham",utcoffset:"-3"})),sessionStorage.setItem("_swa","1")</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-59191973-2","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://www.eduardoaleixo.com/scss/custom.min.4e957ed4d75934c49811ab7b910e5044ba6926a444e9f5982aa289adf6884f47.css integrity="sha256-TpV+1NdZNMSYEat7kQ5QRLppJqRE6fWYKqKJrfaIT0c=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://www.eduardoaleixo.com/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.eduardoaleixo.com/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.101.0"></head><body class=colorscheme-light><div id=page-transitioner></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://www.eduardoaleixo.com/>eduardoaleixo</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><div class=wrap><span class=stripe></span>
<span class=stripe></span>
<span class=stripe></span></div></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/weekly-digest/>Weekly digest</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Automounting Steam Deck SD Card</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i>
<time datetime=2024-08-25T12:43:04+01:00>2024/08/25</time></span>
<span class=reading-time><i class="fas fa-clock"></i>
4-minute read</span></div><div class=categories><i class="fas fa-folder"></i>
<a href=https://www.eduardoaleixo.com/categories/technical/>technical</a></div></div></header><div><p>Normally (I guess), you need to first enter Desktop Mode, which will automount the SD card.
Then you can go back to Game Mode and play your games from the SD card (mostly emulation :) ).</p><p>A good thing of the steam deck is that it just runs Linux, so we can use same old tools we are used too.
What we want here is to add the sd card to <code>fstab</code></p><p>Assuming you have SSH access to the deck.</p><p>I recommend first automounting it via Desktop mode. It should auto mount to <code>/run/media/deck/{UUID}</code>,
you can double check with <code>df -T</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>/dev/mmcblk0p1 btrfs    999868416 269506996 729257116  27% /run/media/deck/7408fbbe-276b-4f85-8494-d9549daa4ba0
</span></span></code></pre></td></tr></table></div></div><p>So mine is using <code>btrfs</code>, pay attention to this, if yours is different the fstab config may change.
Not gonna go into filesystems and whatnot, if you want to be able to access the SD card in a non Linux machine
I recommend exFAT (which works in Mac too) and NTFS (Windows only, although I think you can use a third party tool to have write access in a Mac).</p><p>Then, since it&rsquo;s already mounted, you can peek into <code>/etc/mtab</code> and literally just copy</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>cat /etc/mtab 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/dev/mmcblk0p1 /run/media/deck/7408fbbe-276b-4f85-8494-d9549daa4ba0 btrfs rw,nosuid,nodev,relatime,ssd,space_cache=v2,subvolid=5,subvol=/ 0 0
</span></span></code></pre></td></tr></table></div></div><p>Although we need to modify slightly.
Find that partition&rsquo;s UUID using <code>lsblk -oNAME,UUID</code></p><p>Then edit <code>/etc/fstab</code>, we need to do 2 changes from what we got from <code>/etc/mtab</code>:</p><ol><li>Prefix with <code>UUID={YOUR_UUID}</code>. This is necessary so that in case the drive name changes (right now it&rsquo;s <code>/dev/mmcblk0p1</code>), it can be looked up via the UUID.</li><li>Add <code>nofail</code> to the options, this is super important so that it won&rsquo;t prevent your steam deck to boot in case the SD card can&rsquo;t be read.</li></ol><p>So in my case I added all this to <code>fstab</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>UUID=7408fbbe-276b-4f85-8494-d9549daa4ba0 /run/media/deck/7408fbbe-276b-4f85-8494-d9549daa4ba0 btrfs nofail,rw,nosuid,nodev,relatime,ssd,space_cache=v2,subvolid=5,subvol=/ 0 0
</span></span></code></pre></td></tr></table></div></div><p>Unmount the existing mount point <code>umount /run/media/deck/7408fbbe-276b-4f85-8494-d9549daa4ba0</code> in my case. You may get a <code>Resource busy</code>, in that case you can technically track all the places that are using that disk using <code>lsof</code> and kill them. Honestly if that happens, I recommend instead to just comment out that line in <code>fstab</code>, then rebooting and immediately going to desktop mode, then you can try to umount again.</p><p>Run <code>mount -a</code> everything that&rsquo;s in <code>fstab</code>.</p><p>If it works, reboot and it should be automounting.</p><p>Now to make it available in Game Mode (to be able to install Steam games), go to Desktop Mode, open Steam -> Settings -> Storage -> Add Drive, then add your SD card.</p><p>It should work now.</p><h1 id=bonus-breaking-down-my-fstab-config>bonus: breaking down my fstab config</h1><p>As I just copied whatever was in <code>/etc/mtab</code>, I didn&rsquo;t fully understand everything. So let&rsquo;s look at the docs:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>/dev/mmcblk0p1 /run/media/deck/7408fbbe-276b-4f85-8494-d9549daa4ba0 btrfs nofail,rw,nosuid,nodev,relatime,ssd,space_cache=v2,subvolid=5,subvol=/ 0 0
</span></span></code></pre></td></tr></table></div></div><p><code>nofail</code> -> already explained, won&rsquo;t prevent the boot to fail if the partition can&rsquo;t be found
<code>rw</code> -> obvious enough, to allow reading and writing
<code>nosuid</code> -> don&rsquo;t allow having the suid and sgid bits, this is a little complicated, but long story short is a bit that a file can have which will allow anyone to run that as if they were the user that owns the file, the most common case I know is to run as root, like for the <code>sudo</code> binary, since sudo itself allows you to run as root (the owner of the file)
<code>nodev</code> -> not quite sure, I believe it doesn&rsquo;t allow the filesystem to contain special files, which usually allows talking directly to the device hardware
<code>relatime</code> -> <a href=https://en.wikipedia.org/wiki/Stat_(system_call)#Criticism_of_atime>some low level stuff about access time</a>, don&rsquo;t care really much
<code>ssd</code> -> for what I understand it enables auto detection of ssd and btrfs add some optimizations (<a href=https://man.archlinux.org/man/core/btrfs-progs/btrfs.5.en>https://man.archlinux.org/man/core/btrfs-progs/btrfs.5.en</a>)
<code>space_cache=v2</code> -> defaults to v2 which is better, not sure why it&rsquo;s set (<a href=https://man.archlinux.org/man/core/btrfs-progs/btrfs.5.en>https://man.archlinux.org/man/core/btrfs-progs/btrfs.5.en</a>)
<code>subvol=/</code> -> mounts from a path, not sure it&rsquo;s useful here</p><p>Now looking at all this, it looks like we can simplify it a bit if we use <code>defaults</code>. I found that the kernel has the following defaults <code>rw, suid, dev, exec, auto, nouser, and async.</code> (<a href=https://man7.org/linux/man-pages/man5/fstab.5.html)>https://man7.org/linux/man-pages/man5/fstab.5.html)</a>, but in reality it may depend on the filesystem, apparently btrfs <a href=https://www.jwillikers.com/btrfs-mount-options>don&rsquo;t set anything</a>? But then <a href=https://old.reddit.com/r/btrfs/comments/14t7mjr/where_to_find_default_mount_options/jr21uj7/>someone says there are defaults</a> which are different from the kernel&rsquo;s one.</p><p>You know what? I will leave as it is.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>© 2020 - 2025
eduardo aleixo's cafofo
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><link rel=stylesheet href=https://www.eduardoaleixo.com/scss/fouc.css media=screen></body></html>