<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><style>html{display:none}</style><meta name=author content="eduardo aleixo's cafofo"><meta name=description content="eduardo aleixo's personal website"><meta name=keywords content="developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Run only benchmark in go(lang)"><meta name=twitter:description content="a quick go(lang) tip
let&rsquo;s say you have tests and benchmarks in your codebase and you want to run only benchmarks, or to put in other words, to filter out all tests from being executed
unfortunately there&rsquo;s no --bench-only nor anything similar available, but there&rsquo;s a trick popular in the community that does the job
the idea is to basically filter out all tests with an unlikely regex
1 2 3 4 go test ."><meta property="og:title" content="Run only benchmark in go(lang)"><meta property="og:description" content="a quick go(lang) tip
let&rsquo;s say you have tests and benchmarks in your codebase and you want to run only benchmarks, or to put in other words, to filter out all tests from being executed
unfortunately there&rsquo;s no --bench-only nor anything similar available, but there&rsquo;s a trick popular in the community that does the job
the idea is to basically filter out all tests with an unlikely regex
1 2 3 4 go test ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.eduardoaleixo.com/posts/run-only-benchmark-go/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-22T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-22T00:00:00+00:00"><base href=https://www.eduardoaleixo.com/posts/run-only-benchmark-go/><title>Run only benchmark in go(lang) · eduardoaleixo</title><link rel=canonical href=https://www.eduardoaleixo.com/posts/run-only-benchmark-go/><link rel=stylesheet href=https://www.eduardoaleixo.com/css/coder.min.0caa4ac67ec36ec2dedf930b12e60fdae22c952b84d9f102d59ced9d35491132.css integrity="sha256-DKpKxn7DbsLe35MLEuYP2uIslSuE2fEC1ZztnTVJETI=" crossorigin=anonymous media=screen><script type=text/javascript src=https://www.eduardoaleixo.com/js/script.js></script>
<script>!sessionStorage.getItem("_swa")&&document.referrer.indexOf(location.protocol+"//"+location.host)!==0&&fetch("https://counter.dev/track?"+new URLSearchParams({referrer:document.referrer,screen:screen.width+"x"+screen.height,user:"eham",utcoffset:"-3"})),sessionStorage.setItem("_swa","1")</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-59191973-2","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://www.eduardoaleixo.com/scss/custom.min.4e957ed4d75934c49811ab7b910e5044ba6926a444e9f5982aa289adf6884f47.css integrity="sha256-TpV+1NdZNMSYEat7kQ5QRLppJqRE6fWYKqKJrfaIT0c=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://www.eduardoaleixo.com/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.eduardoaleixo.com/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.101.0"></head><body class=colorscheme-light><div id=page-transitioner></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://www.eduardoaleixo.com/>eduardoaleixo</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><div class=wrap><span class=stripe></span>
<span class=stripe></span>
<span class=stripe></span></div></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://www.eduardoaleixo.com/weekly-digest/>Weekly digest</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Run only benchmark in go(lang)</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i>
<time datetime=2021-07-22T00:00:00Z>2021/07/22</time></span>
<span class=reading-time><i class="fas fa-clock"></i>
1-minute read</span></div><div class=categories><i class="fas fa-folder"></i>
<a href=https://www.eduardoaleixo.com/categories/technical/>technical</a></div><div class=tags><i class="fas fa-tag"></i>
<a href=https://www.eduardoaleixo.com/tags/go/>go</a>
<span class=separator>•</span>
<a href=https://www.eduardoaleixo.com/tags/golang/>golang</a></div></div></header><div><p>a quick go(lang) tip</p><p>let&rsquo;s say you have tests and benchmarks in your codebase
and you want to <strong>run only benchmarks</strong>, or to put in other words, to <strong>filter out all tests</strong> from being executed</p><p>unfortunately there&rsquo;s no <code>--bench-only</code> nor anything similar available,
but there&rsquo;s a trick popular in the community that does the job</p><p>the idea is to basically filter out all tests with an unlikely regex</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>go test ./... -bench=. \
</span></span><span style=display:flex><span>  -run=dwioajd2qjdowajdq2jodfwioaaaadlzndwadjwionmilafmaeopdwpaod \
</span></span><span style=display:flex><span>  pakdwioadjwioajdwaiojdwaiowdjaiodwajwdaiojdaiowdjaiodwajiodwajiodwajwd \
</span></span><span style=display:flex><span>  aiwdoajdwioajwdioadwa
</span></span></code></pre></td></tr></table></div></div><p><img src=https://media.giphy.com/media/unQ3IJU2RG7DO/giphy.gif alt="cat bashing the keyboard"></p><p>but of course we can do better with a clever regex</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>go test ./... -bench=. -run=^$
</span></span></code></pre></td></tr></table></div></div><p>as you may be aware, <code>^</code> matches the beginning of a string and <code>$</code> the end
so it tries to match a string that&rsquo;s empty</p><p>naturally there&rsquo;s no test with empty name, otherwise the parser would fail, i think</p><p>therefore it ends up filtering out all tests, so only benchmarks run</p><p>one minor inconvenience is that in the fish shell we need to escape the <code>$</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>Fish: Expected a variable name after this $.
</span></span></code></pre></td></tr></table></div></div></div><footer></footer></article></section></div><footer class=footer><section class=container>© 2020 - 2024
eduardo aleixo's cafofo
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><link rel=stylesheet href=https://www.eduardoaleixo.com/scss/fouc.css media=screen></body></html>